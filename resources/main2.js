const data = {"0" : {name: "Art", imgUrl: "resources/img/Art.jpg", longitude:16.603373738961409, latitude:49.204186978229387, otherNames: ["Jugendkino", "Studio", "Kino náročného diváka"]},
"1" : {name: "Astra", imgUrl: "", longitude:16.643282126278734, latitude:49.201342788954165, otherNames: ["Kino Sokol", "Hvězda"]},
"2" : {name: "Bio Jas Husovice", imgUrl: "resources/img/Jas.png", longitude:16.636497311000248, latitude:49.213012536011753, otherNames: []},
"3" : {name: "Čas", imgUrl: "resources/img/Cas.png", longitude:16.611677348986568, latitude:49.191389666128529, otherNames: ["Apollo", "Ohne Pause", "Aktualita"]},
"4" : {name: "Vlast", imgUrl: "resources/img/Vlast.png", longitude:16.622027653926690, latitude:49.180076868111804, otherNames: ["Kino Atlantik"]},
"5" : {name: "Dukla", imgUrl: "", longitude:16.600665005310685, latitude:49.202920401220588, otherNames: ["Kino Stadion"]},
 "6" : {name: "Hvězda", imgUrl: "", longitude:16.553491500102655, latitude:49.217529300366998, otherNames: ["Kino Komín"]},
 "7" : {name: "Jadran", imgUrl: "resources/img/Jadran.png", longitude:16.595550431548450, latitude:49.223679124352600, otherNames: ["Adria", "Bio Besední dům"]},
 "8" : {name: "Jalta", imgUrl: "resources/img/Jalta.jpeg", longitude:16.606333441544635, latitude:49.194223116939263, otherNames: ["Kino Moderna"]},
 "9" : {name: "Kapitol", imgUrl: "resources/img/Kapitol.png", longitude:16.614135113704798, latitude:49.195054457938845, otherNames: ["The Royal Bio Co.", "Elite Kino", "Družba"]},
 "10" : {name: "Kino Excelsior", imgUrl: "resources/img/Excelsior.png", longitude:16.605411779775292, latitude:49.192520803678747, otherNames: []},
 "11" : {name: "Kino Moravia", imgUrl: "resources/img/Moravia.png", longitude:16.606359403848000, latitude:49.203576311221532, otherNames: []},
 "12" : {name: "Kino Republika", imgUrl: "resources/img/Republika.png", longitude:16.606917593370277, latitude:49.195376810893663, otherNames: []},
 "13" : {name: "Kino Slávia Starý Lískovec", imgUrl: "", longitude:16.564910586531106, latitude:49.163510266646696, otherNames: []},
 "14" : {name: "Kino Slunce", imgUrl: "", longitude:16.562487438217360, latitude:49.180438917707157, otherNames: []},
 "15" : {name: "Kino Vesmír", imgUrl: "", longitude:16.551449132238215, latitude:49.209072042807925, otherNames: []},
 "16" : {name: "Květen", imgUrl: "", longitude:16.599289003232524, latitude:49.215584711490401, otherNames: ["Vitagraf", "Illusion", "Elektra"]},
 "17" : {name: "Lípa", imgUrl: "resources/img/Lipa.png", longitude:16.623343077297044, latitude:49.201342788954101, otherNames: []},
 "18" : {name: "Lucerna", imgUrl: "resources/img/Lucerna.png", longitude:16.585546290653109, latitude:49.210474148121463, otherNames: ["Bio Aladin"]},
 "19" : {name: "Luna", imgUrl: "", longitude:16.583711621215556, latitude:49.187628447806674, otherNames: ["Výstavní kino", "Elite", "Deutsche Lichtspiele"]},
 "20" : {name: "Máj", imgUrl: "", longitude:16.530917277329610, latitude:49.176003627659583, otherNames: ["Kino Sokola", "Kino Bosonohy", "Svoboda"]},
 "21" : {name: "Morava", imgUrl: "resources/img/Morava.png", longitude:16.607700789521690, latitude:49.201472844915209, otherNames: ["Bio Universum", "Bio Metro"]},
 "22" : {name: "Oko", imgUrl: "resources/img/Oko.png", longitude:16.595515815143962, latitude:49.221825213876301, otherNames: ["Union"]},
 "23" : {name: "Orania", imgUrl: "resources/img/Orania.png", longitude:16.617769836175416, latitude:49.198945174310872, otherNames: ["Urania"]},
 "24" : {name: "Praha", imgUrl: "resources/img/Praha.bmp", longitude:16.610110956683755, latitude:49.194618995348172, otherNames: ["Bio Alfa"]},
 "25" : {name: "Radost", imgUrl: "", longitude:16.623135378870149, latitude:49.198809456798585, otherNames: ["Kino-Varieté", "Bajkal", "Radio"]},
 "26" : {name: "Scala", imgUrl: "resources/img/Scala.png", longitude:16.608142148678841, latitude:49.197356125091055, otherNames: ["Bio Dopz", "Moskva"]},
 "27" : {name: "Sibiř", imgUrl: "resources/img/Sibir.png", longitude:16.633658765832720, latitude:49.211655730191630, otherNames: ["Zora"]},
 "28" : {name: "Slovan", imgUrl: "", longitude:16.635458818865757, latitude:49.189760782619359, otherNames: ["Kino Avia"]},
 "29" : {name: "Sokolovo", imgUrl: "", longitude:16.651382364927571, latitude:49.228839185751077, otherNames: ["Kino Sokol Obřany"]},
 "30" : {name: "Sport", imgUrl: "", longitude:16.642035935717360, latitude:49.198809456798656, otherNames: ["Bio Slávia"]},
 "31" : {name: "Světozor", imgUrl: "resources/img/Svetozor.png", longitude:16.639197390549828, latitude:49.199442802003169, otherNames: []},
 "32" : {name: "Svoboda", imgUrl: "resources/img/Svoboda.png", longitude:16.591084915370256, latitude:49.190524328441683, otherNames: ["The Loyal", "Starobrněnské kino", "Grand"]},
 "33" : {name: "Úderka", imgUrl: "resources/img/Uderka.png", longitude:16.608462350420282, latitude:49.195546469499831, otherNames: ["The Empire Bio-Co.", "Ufa-Central"]},
 "34" : {name: "Viktoria", imgUrl: "", longitude:16.618773711905359, latitude:49.187679353422347, otherNames: ["Brněnský biograf", "Kino Dornych", "Edison"]},
 "35" : {name: "Vítěz", imgUrl: "", longitude:16.604650218876646, latitude:49.163419723539690, otherNames: ["Kino Adria Horní Heršpice"]}
}

scriptPrevendDefaultError()

const numOfLevels = 1
const numOfCinemas = Object.keys(data).length
const displayStates = {0:'intro', 1:'start', 2:'question', 3:'result', 4:'summary'}
const markerStates = {0:'without', 1:'green', 2:'red', 3:'yellow', 4:'selection'}

const fromProjection = new OpenLayers.Projection("EPSG:4326"); // transform from WGS 1984
const toProjection = new OpenLayers.Projection("EPSG:900913"); // to Spherical Mercator Projection
const map_center = new OpenLayers.LonLat(16.608196,49.195047)
const map_center_transformed = map_center.transform(fromProjection, toProjection);
const map_zoom = 14;
const extent = new OpenLayers.Bounds( 16, 48, 17, 50).transform(fromProjection, toProjection);
const options = {restrictedExtent: extent};

const quizButton = document.getElementById('quizButton');
const startButton = document.getElementById('startButton');
const exitButton = document.getElementById('exitButton');
const confirmButton = document.getElementById('confirmButton');
const nextButton = document.getElementById('nextButton');
const introPage = document.getElementById('introPage');
const startPage = document.getElementById('startPage');
const quizPage = document.getElementById('quizPage');
const summaryPage = document.getElementById('summaryPage');
const endImg = document.getElementById('endImg');
const endInfo = document.getElementById('endInfo');
const questionResult = document.getElementById('questionResult');
const questionResultContainer = document.getElementById('questionResultContainer');
const questionId = document.getElementById('questionId');
const summaryText = document.getElementById('summaryText');
const inputNickname = document.getElementById("inputLGEx")
const table = document.getElementById("myTable").getElementsByTagName("tbody")[0];

var totalPoints = 0;
var level = 0;
var display = displayStates[0]

///////////////////////

displayPage()
map = mapInit()

//////////////////////////////////////////////////////////////////////////////////

quizButton.addEventListener('click', (event) => {
    display = displayStates[1]
    displayPage()

});

startButton.addEventListener('click', (event) => {
    display = displayStates[2]
    displayPage()

    nickname = inputNickname.value

    cinemaOrder = getCinemaOrder()
    markerStateValues = initMarkerStates()
    newQuestion()

    level ++;
});

exitButton.addEventListener('click', (event) => {
    display = displayStates[0]
    displayPage()

    inputNickname.value = '';
    level = 0;

    mapRecenter(map);
    resetMarkers('all');
});

confirmButton.addEventListener('click', (event) => {
    display = displayStates[3]
    displayPage()

    makeResult();
    mapRecenter(map);
});

nextButton.addEventListener('click', (event) => {
    if (cinemaOrder.length == level)
    {
        display = displayStates[4]
        displayPage()

        resetMarkers('some');

        total_res = getTotalResult()
        summaryText.innerHTML = ''.concat(inputNickname.value, ', tvoje skóre je ', total_res.toString(),
            '/', numOfLevels)

        var row = table.insertRow(0);
        var cell0 = row.insertCell(0);
        var cell1 = row.insertCell(1);
        var cell2 = row.insertCell(2);

        // cell0.innerHTML = table.getElementsByTagName("tr").length;
        // cell1.innerHTML = inputNickname.value;
        // cell2.innerHTML = total_res;

        $($.fn.dataTable.tables(true)).DataTable()
        .columns.adjust();

        var cnt = $('#myTable').DataTable().rows().count()

        $('#myTable').DataTable().row.add([
            cnt + 1,
            inputNickname.value,
            total_res
        ]).draw(false);
    }
    else
    {
        display = displayStates[2]
        displayPage()

        resetMarkers('some');
        newQuestion();
        level ++;
    }

    questionResult.style.height = "10%";
});


$(document).ready(function () {
$('#myTable').DataTable(
    {
        // scrollY:        "200px",
scrollCollapse: true,
paging:         false,
scrollX: "100%",
searching: false,
info:false
    }
);
$('.dataTables_length').addClass('bs-select');
});



var svg = d3.select("#time-range-picker"),
    widthAll = parseInt(svg.style("width"), 10),
    heightAll = parseInt(svg.style("height"), 10),
    // margin = {top: heightAll/50, right: 0, bottom: heightAll/50, left: 0},
    margin = {top: 0, right: 0, bottom: 0, left: 0},
    width = widthAll - margin.left - margin.right,
    height = heightAll - margin.top - margin.bottom,
    midX = width/2

svg.attr("viewBox", "0 0 " + widthAll + " " + heightAll)

var mindate = new Date(1830,0,1),
    maxdate = new Date(2030,0,1)

var y = d3.scaleTime()
    .domain([mindate, maxdate])
    .range([0, height])

var brush = d3.brushY()
    .extent([[0, 0], [width, height]])
    .on("end", brushed);

var context = svg.append("g")
    .attr("class", "context")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

context.append("g")
    .attr("class", "brush")
    .call(brush)
    .call(brush.move, y.range())

context.selectAll('rect.extent')
    			.style('fill', 'red')
    			.style('fill-opacity', .3)
    			.style('stroke', '#999')
    			.style('stroke-width', .5);

// context.selectAll('g.resize')
//     .selectAll('rect')
//     .attr('rx', 3)
//     .attr('ry', 3)
//     .attr('width', 5)
//     .style('visibility', 'visible')
//     .style('fill', '#019ed5')
//     .style('fill-opacity', .7)

svg.append("g")
    .attr("class", "axis axis--grid")
    .attr("transform", "translate(" + margin.left + 1 + "," + margin.top + ")")
    .call(d3.axisRight(y)
        .tickArguments([d3.timeYear.every(20)])
        .tickSize(15)
        .tickFormat(function() { return null; }))

svg.append("g")
    .attr("class", "axis axis--x")
    .attr("transform", "translate(" + margin.left + 1.2 * midX / 2 + "," + (margin.top - 15) + ")")
    .call(d3.axisRight(y)
        .tickArguments([d3.timeYear.every(20)])
        .tickFormat(d3.timeFormat("%Y"))
        .tickSize(0)
        .tickPadding(-16))
    .attr("text-anchor", null)
    .selectAll("text")

function brushed() {
	if (!d3.event.selection) return; // Ignore empty selections.
  var d0 = d3.event.selection.map(y.invert),
      d1 = d0.map(d3.timeYear.round);

  console.log(d1[0])
  console.log(d1[1])
  console.log("")

  /* d3.select(this).transition().call(d3.event.target.move, d1.map(y)) */;
}
